{{ define "main" }}
<div class="homepage-wrapper">

    <!-- 1. FEATURED SECTION (Top 1 Post) -->
    <!-- Get strict list of blog posts only -->
    {{ $posts := where .Site.RegularPages "Section" "posts" }}
    {{ $featured := first 1 $posts }}

    {{ range $featured }}
    <section class="featured-section">
        <h3 class="section-title"><span>BÀI VIẾT NỔI BẬT</span></h3>
        <article class="featured-post">
            <span class="featured-badge"><i class="fas fa-star"></i> Featured</span>
            <div class="featured-thumb">
                <a href="{{ .Permalink }}">
                    {{ $image := .Params.image | default "/images/default-thumbnail.jpg" }}
                    <img src="{{ $image }}" alt="{{ .Title }}">
                </a>
            </div>
            <div class="featured-content">
                <div class="post-meta-top">
                    <span class="post-date">{{ .Date.Format "02/01/2006" }}</span>
                    <span class="meta-divider">•</span>
                    {{ with .Params.categories }}
                    <span class="post-cat">
                        {{ range first 1 . }}
                        <a href="{{ " /categories/" | relURL }}{{ . | urlize }}/">{{ upper . }}</a>
                        {{ end }}
                    </span>
                    {{ end }}
                </div>
                <h2 class="featured-title">
                    <a href="{{ .Permalink }}">{{ .Title }}</a>
                </h2>
                <div class="featured-excerpt">
                    {{ .Summary | truncate 220 }}
                </div>
                <a href="{{ .Permalink }}" class="read-more-btn">Đọc tiếp <i class="fas fa-arrow-right"></i></a>
            </div>
        </article>
    </section>
    {{ end }}

    <!-- 2. LATEST POSTS LIST (Remaining posts) -->
    <section class="latest-posts-section">
        <h3 class="section-title"><span>BÀI VIẾT MỚI NHẤT</span></h3>
        <div class="posts-list-container">
            <!-- Range over the rest of the posts -->
            {{ range after 1 $posts }}
            <article class="post-card-horizontal">
                <div class="post-thumb">
                    <a href="{{ .Permalink }}">
                        {{ $image := .Params.image | default "/images/default-thumbnail.jpg" }}
                        <img src="{{ $image }}" alt="{{ .Title }}" loading="lazy">
                    </a>
                </div>

                <div class="post-content-wrap">
                    <div class="post-meta-top">
                        <span class="post-date">{{ .Date.Format "02/01/2006" }}</span>
                        <span class="meta-divider">•</span>
                        {{ with .Params.categories }}
                        <span class="post-cat">
                            {{ range first 1 . }}
                            <a href="{{ " /categories/" | relURL }}{{ . | urlize }}/">{{ upper . }}</a>
                            {{ end }}
                        </span>
                        {{ end }}
                    </div>

                    <h2 class="post-title">
                        <a href="{{ .Permalink }}">{{ .Title }}</a>
                    </h2>

                    <div class="post-excerpt">
                        {{ .Summary | truncate 150 }}
                    </div>
                </div>
            </article>
            {{ end }}
        </div>
    </section>

    <!-- Pagination (Standard Hugo Pagination) -->
    {{ template "_internal/pagination.html" . }}
</div>
{{ end }}